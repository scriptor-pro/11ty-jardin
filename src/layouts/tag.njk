{% extends "base.njk" %}

{% block content %}

{% set tagName = tag or (tagObj and tagObj.tag) %}
{% set tagNotes = collections[tagName] or [] %}

<section class="tag-page">

  <h1 class="tag-title">
    Tag : <span>{{ tagName }}</span>
  </h1>

  <p class="tag-count">
    {{ tagNotes | length }} note{% if tagNotes | length > 1 %}s{% endif %}
  </p>

  <hr class="tag-separator">

  <ul class="tag-note-list">
    {% for note in tagNotes %}
    <li class="tag-note-item">
      <a href="{{ note.url | safelink }}" class="tag-note-link">

        <span class="tag-note-title">{{ note.data.title }}</span>

        {# Statut visuel #}
        {% set hasCqjaTag = note.data.tags and ("cqja" in note.data.tags) %}
        {% set statusValue = hasCqjaTag ? "cqja" : note.data.status %}
        {% set normalizedStatus = statusValue and statusValue | lower %}
        <span class="tag-note-status">
          {% if normalizedStatus == "idee" or normalizedStatus == "idÃ©e" %}
            ðŸ’­ idÃ©e
          {% elif normalizedStatus == "chantier" %}
            ðŸ”§ chantier
          {% elif normalizedStatus == "termine" or normalizedStatus == "terminÃ©" %}
            âœ¨ terminÃ©
          {% elif normalizedStatus == "cqja" %}
            ðŸ“‘ cqja
          {% else %}
            âšªï¸Ž
          {% endif %}
        </span>

      </a>
    </li>
    {% endfor %}
  </ul>

</section>

{% endblock %}
